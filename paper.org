#+TITLE: Heterogenous firing responses lead to diverse couplings to presynaptic activity
#+AUTHOR: Y. Zerlaut^{1} \& A. Destexhe^{1}
#+INCLUDE: my_template.org 

* Abstract

  \bfseries

  Neocortical processing of sensory input rely on the specific
  activation of subpopulations within the cortical network. Though
  specific circuitry is thought to be the primary mechanism underlying
  this functional principle, we investigate here a putative
  complementary mechanism: whether diverse biophysical features in
  single neurons contribute to such differential activation.

  In a companion study [[cite:Zerlaut2016]], we reported that, in young
  mice visual cortex, individual neurons differ not only in their
  excitability but also in their sensitivities to the properties of
  the membrane potential fluctuations. In the present work, we analyze
  how this heterogeneity is translated into diverse input-ouput
  properties (i.e. in the relation from presynaptic quantities to
  spiking probability) in the context of low synchrony population
  dynamics. 

  To this purpose, we designed a simplified morphological model of
  layer V pyramidal neurons with a dendritic tree following Rall's
  branching rule. We first show that we are able to calibrate this
  simplified model on /in vitro/ measurements of somatic input
  impedance. We then propose an analytical derivation for the membrane
  potential fluctuations at the soma as a function of the properties
  of the synaptic bombardment. This mathematical description allows to
  easily emulate various forms of presynaptic activities: either
  balanced, unbalanced, synchronized, purely proximal or purely distal
  synaptic activity. 

  We found that those different forms of activity led to various
  comodulations of the membrane potential fluctuation properties, thus
  raising the question whether individual neurons might differentially
  couple to specific forms of activity because of their various firing
  responses to fluctuations. 

  We indeed found such an heterogenous response, but trivially, the
  only significant contribution to the various firing response was the
  different levels of cellular excitability. A notable exception
  appeared for proximal activity: increasing proximal activity could
  either promote firing response in some cells or suppress it in some
  other cells whatever their individual excitability. This behavior
  could only be explained by various sensitivities to the speed of the
  fluctuations, that was previously linked to heterogenous levels of
  sodium inactivation and sodium channels density.

  In addition to giving quantitative insight on the impact of various
  excitability levels in individual neurons, the present study
  suggests a new functional impact of biophysical heterogeneity:
  various levels of density of sodium channels and sodium inactivation
  will control the response of individual neurons to proximal
  activity.

\normalfont

* Introduction

Neocortical processing of sensory input rely on the specific
activation of subpopulations within the cortical network. The details
of how such specific activations happen are key questions in systems
neuroscience. As a primary source for specific activation, the
neocortex is characterized by some degree of specific circuitry:
neurons differ in their afferent connectivity. A classical example can
be found in the primary cortex, layer IV simple cells specifically
sample their input from ON and OFF cells in the thalamic nucleus
[[cite:Hubel1962,Ferster1996]]. Neocortical neurons also vary in their
electrophysiological properties: for example, heterogenous levels in
the action potential threshold are routinely measured /in vivo/
[[cite:Crochet2011,Okun2015,Yang2015]]. Thus, an emerging refinment is
that the sensitivity of a neuron to a given feature do not only
results from its /circuit specificity/ (relative to this feature,
e.g. orientation selectivy), but from the combination of its /circuit
specificity/ and its /biophysical specificity/. The somato-sensory
cortex studies of [[citetext:Crochet2011]] and [[citetext:Yang2015]]
illustrates this point precisely. In [[citetext:Crochet2011]], during
active touch, the response probability of a neuron (its sensitivity to
whisker touch) follows from the combination of the reached level of
synaptically-driven membrane potential deflection (resulting from its
/circuit-specificity/) and its threshold for action potential
triggering (its /biophysical specificity/). The same result hold for
texture recognition in the study of [[citetext:Yang2015]] where only the
combination of those two quantities was shown to predict
choice-related spiking. Those results therefore suggest that
heterogeneity in the electrophysiological or biophysical properties of
neocortical neurons might have an impact on their functional role
during sensory processing.

In the present work, we further investigate this putative interaction
in the light of the variability in the biophysical features reported
in our companion communication, namely that single neurons in juvenile
mice cortex not only vary in their excitability (linked to the action
potential threshold) but also in their sensitivity to the properties
of the membrane potential fluctuations. Our previous communication
introduced those new dimensions in the /biophysical specificity/ and
we now aim at understanding their functional impact.

To highlight the impact of the /biophysical specificity/, we will
investigate single neuron responses in a framework where the /circuit
specificity/ of individual neurons is null, i.e. with the hypothesis
that all neurons sample statistically equally their input.

In the context of low synchrony population dynamics
[[cite:Ecker2010,Renart2010]], where the neuronal response can be
described as a spiking probability and the input can be described by
presynaptic firing rates, we implemented various types of presynaptic
activity: either unbalanced (to emulate net excitatory input), purely
proximal (to emulate local network input [[cite:Spruston2008]]), purely
distal (to emulate long-range or thalamic input [[cite:Spruston2008]]) or
of increased synchrony (to emulate changes in input statistics
[[cite:Baudot2013,ElBoustani2009]]). We found that those various types of activity
corrresponds to different variations of the properties of the membrane
potential fluctuations (mean depolarization, standard deviation and
autocorrelation time). The various firing responses (as a function of
the fluctuation properties) for individual neurons found in our
companion study then led to diverse coupling to each activity type.

We designed a theoretical model for passive dendritic integration that
allows an analytical treatment and thus easily enables the
implementation of various types of presynaptic activity. It is based
on a symmetrical morphology where branching follows the Rall's 3/2
exponent rule [[cite:Rall1962]], the analytical derivation relies on
adapting the equivalent cylinder transformation [[cite:Rall1962]] to the
properties of the high conductance state [[cite:Destexhe2003]].

We suggested in our companion study that the properties of the
fluctuations could follow various comodulations depending on the type
of presynaptic activity, what we demonstrate in this study.

* Results 
\normalsize

The results are organized as follows. We first formulate our
theoretical framework for cellular computation which arbitrarily
separate the question of dendritic integration and spiking
probability. Then we present our simplified model of dendritic
morphology which we calibrated on /in vitro/ measurements. We derive
an analytical approximation for the membrane potential fluctuations at
the soma that we compare to numerical simulations using standard
compartemental modeling. We implement various types of presynaptic
activity we analyze the individual responses of the layer V pyramidal
cells characterized in our companion study for those various types of
presynaptic activities.

** A theoretical framework for single cell computation in the fluctuation-driven regime

#+ATTR_LATEX: :width .98\linewidth
#+NAME: fig:model-illustration
#+CAPTION: *A theoretical framework for single cell computation in the fluctuation-driven regime*. *(A)* Theoretical paradigm: to get the input-output function of a single cell, we split the relation from presynaptic quantities (the input) to the spiking probability (the output) into two steps. 1) passive dendritic integration shape the membrane potential at the soma and 2) how those fluctuations are translated into spikes is captured by a firing response function determined /in vitro/ [[cite:Zerlaut2016]] *(B)* Theoretical model for dendritic integration. A single cell is made of a lumped impedance somatic compartment and a dendritic tree. The dendritic tree is composed of B branches (here B=5), the branching is symmetric and follow Rall's 3/2 rule for the branch diameters. Synapses are then spread all over the membrane according to physiological synaptic densities. We define 3 domains: a somatic and proximal domain as well as a distal domain, excitatory and inhibitory synaptic input can vary independently in those domains. An additional variable: synaptic synchrony controls the degree of coincidents synaptic inputs. *(C)* A given presynaptic stimulation (here \nu_e^p=\nu_e^d=0.2Hz, \nu_i^p=\nu_i^d=1.2Hz and s=0.05) creates membrane potential fluctuations at the soma characterized by their mean \(\mu_V\), their amplitude \(\sigma_V\) and their autocorrelation time \(\tau_V\).
[[file:./figures/model_illustration.png]]

In the fluctuation-driven regime, the cellular input-output function
of a neocortical neuron corresponds to the function that maps the
presynaptic variables to the spiking probability of the neuron (this
is true both in a rate coding paradigm [[cite:Shadlen1994]] or in a
stochastic temporal coding paradigm [[cite:Rossant2011]]). In addition,
because our study focuses on effects resulting from population
dynamics, the presynaptic variables will have a simple description:
firing rates and a synchrony degree.

# Determining the cellular input-output functions is complex because
# input of neocortical neurons are mostly in dendrites and output spikes
# are generated in initial segments of an axon as reviewed in
# [[citetext:Stuart2015]] and [[citetext:Debanne2011]] input will therefore
# crucially shape their input-output relationship. Various parameters of
# presynaptic activity can arbitrarily control the properties of the
# membrane potential fluctuations at the soma. Those properties can be
# quantified by identifying three somatic variables that provide a
# reduced description of the dynamical state at the soma in the
# /fluctuation-driven/ regime: the mean \mu_V, the standard deviation
# \sigma_V of the membrane potential fluctuations and their typical
# autocorrelation time $\tau_V$. For example, the excitatory/inhibitory
# balance controls the mean depolarization at the soma \mu_V, the mean
# synaptic bombardment impacts the standard deviation \sigma_V and the
# speed of the membrane potential fluctuations \tau_V. Other effects
# such as synchrony in the presynaptic spike trains or ratio between
# distally and proximally targeting synaptic activity also affect the
# statistical properties of the fluctuations. The effects of synaptic
# input and its dendritic integration on somatic variables can be
# investigated theoretically using cable theory [[cite:Tuckwell2002]] and
# will be the focus of a future communication.

# Because the spike initiation site lies electrotonically close to the
# soma [[cite:Debanne2011]], we assume that those three purely somatic
# variables will define the firing rate uniquely. In this study we
# investigate the firing response in terms of those somatic variables.

** A simplified morphological model for dendritic integration
<<sec:simplified-model>>

The morphology of our theoretical model is a lumped impedance somatic
compartment in parallel with a dendritic arborization of symmetric
branching following Rall's 3/2 branching rule (see Figure
[[fig:model-illustration]]B and Methods[[sec:morphology]]). This morphology is
of course a very reductive description of pyramidal cells: it does not
discriminate between the distinct apical trunk and the very dense
basal arborization. Also, branching in pyramidal cell morphologies
have been shown to deviate from Rall's 3/2 branching rule. Nonetheless
this simplified model contains the important ingredient for our study:
the fact that the transfer impedance to the soma of a synaptic input
will strongly depend on its location on the dendritic tree. Indeed, as
observed experimentally [[cite:Magee2000]], distal events will be more
low-pass filtered than proximal events in this model.

We spread synapses onto this morphology according to physiological
densitities (taking lower bounds of [[citetext:DeFelipe1992]]) and
describe synaptic events as transient permeability changes of
ion-selective channels (see Methods[[sec:model-equations]]). 

We arbitrarily separate the dendritic tree into two domains: a
proximal and a distal domain (delimited by theur distance to the soma,
see Figure [[fig:model-illustration]]B). The main motivation for this
separation is to distinguish between two types of projections onto
neocortical pyramidal neurons: synaptic inputs from the local network
are thought to be more proximal while the distal apical tuft receives
input from more distant cortical areas and thalamic locations
[[cite:Spruston2008]].

Following experimental evidences
[[cite:Magee2000]], we set a higher synaptic efficacy for distal
synapses. The synaptic parameters take physiological values
[[cite:Destexhe1998]] and can be found on Table [[table:params]]. The passive
and morphological parameters will be estimated from /in vitro/
measurements.

The model has five variables. Four of them are presynaptic firing
rates. To investigate their differential contribution, the proximal
and distal parts of the dendritic trees have been separated and each
of them has two presynaptic rates corresponding to the excitatory and
inhibitory populations (hence four rate variables: \nu_e^p, \nu_i^p,
\nu_e^d, \nu_i^d). Additionally, a global synchrony variable has been
introduced for presynaptic events. This reproduces the effect of
pairwise correlations observed in neocortical assemblies
[[cite:Peyrache2012]] and/or the multi-innervation of a cell by its
presynaptic afferent. The synchrony degree in the presynaptic activity
has been suggested to vary with stimulus statistics in the primary
visual cortex [[cite:Baudot2013,ElBoustani2009]] and justifies its
introduction as a variable.

** Model calibration on /in vitro/ measurements
<<sec:in-vitro-calib>>

#+ATTR_LATEX: :width \linewidth
#+NAME: fig:in-vitro-calib
#+CAPTION: *Calibrating the model on /in vitro/ measurements: the simplified model and its size variations provides an approximation for the somatic input impedance and its heterogeneity*. *(A)* Input impedance (left: modulus and right: phase shift) measured at the soma in intracellular recordings with sine-wave protocols in current-clamp (inset). The color code indicates the input resistance and is likely to result from size variations of individual cells. *(B)* A medium size model accounts for the average data and varying the size of the dendritic tree and soma reproduces the trend in the individual measurements. Large cells (blue) have a lower modulus and a lower phase shift while small cells (red) have both a higher modulus and phase shift. *(C)* We obtain a map between input resistance and size of the morphological model. *(D)* Representation of the medium-size model. *(E)* Additionally the synaptic weights are rescaled with respect to the cell's somatic input resistance. Because the mean transfer resistance to soma is linked to the input resistance, this rescalings insures that the mean synaptic efficacy at soms is the same for all cells.
[[file:./figures/calibration_on_input_imped.png]]

We will use the firing response function of our companion study, we
therefore wanted a characterization of the passive and morphological
properties on the same experimental system: layer V pyramidal neurons
in the primary visual cortex of young mice. To this purpose, we
performed measurements of the input impedance at the soma with
intracellular recordings /in vitro/ in n=13 cells. The key property on
which this characterization relies is the fact that the input
impedance at the soma can not be accounted for only by the
isopotential somatic compartment (i.e. a RC circuit). The input
impedance also shows the contribution of the dendritic tree in
parallel to the soma [[cite:Rall1962]]. Indeed, both the modulus and the
phase of the imput impedance show deviations from the deviations from
the RC circuit impedance (see the comparison in Figure
[[fig:in-vitro-calib]]B): see for example the exponent of the power law
scaling of the modulus (-1 for the single compartment and \sim 0.7 for
pyramidal cells ) or the decreased phase shift at 100Hz.

We first average all data (shown on Figure [[fig:in-vitro-calib]]A) to
obtain a mean input impedance (shown on Figure [[fig:in-vitro-calib]]B)
representative of a mean cellular behavior. We then perfomed a
minimization procedure to obtain both the passive properties and the
morphology corresponding to this average behavior (see
Methods[[sec:fitting]]). The obtained passive properties were compatible
with standard values, e.g. the resulting specific capacitance was 1.05
\(\mu F/cm^2\) close to the 1 \(\mu F/cm^2\) standard, thus suggesting
that the procedure could capture the physiological parameters of
pyramidal cells, see Table [[table:params]] for the other parameters. Also
the obtained morphology seems realistic (B=5 generation of branches, a
total tree length of \(L_t=550\mu\)m and a root branch diameter of the
tree \(D_t =2.25\mu\)m) given what can be observed after histological
work [[cite:Zerlaut2016]]. Most importantly, the surface area was
physiologically realistic, so that when using synaptic densities, we
obtain an accurate number of synapses. A representation of this mean
morphology can be seen on Figure [[fig:in-vitro-calib]]D.

Pyramidal cells show a great variablity in input impedance, for
example their input resistance almost spans one order of magnitude
(both in the present n=13 cells, see the low frequency modulus values
in Figure [[fig:in-vitro-calib]]A, as well as in the firing response
dataset, see bottom in Figure [[fig:in-vitro-calib]]C). We found that
varying the size of the morphological model within a given range
around the mean morphological model could partially reproduce the
observed variability in the input impedance profiles (see Figure
[[fig:in-vitro-calib]]B). Size variations corresponds to a linear
comodulation of the 1) tree length L_t, 2) the diameter of the root
branch D_t and 3) the length of the somatic compartment L_S (see
Figure [[fig:in-vitro-calib]]C for the range of their variations). On
Figure [[fig:in-vitro-calib]]A, the cells have been colored as a function
of their input resistance while on Figure [[fig:in-vitro-calib]]B, we vary
the size of the size of the morphological model. Large cells (blue,
low input resistance) tend to have a lower input resistance and phase
shift than the small cells (red, high input resistance). Note that
this very simplistic account of morphological variations only very
partially describes the observed behavior in pyramidal cells. In
particular, it strongly underestimates the variations of phase shifts
at medium and high frequencies (f>20Hz). This discrepancy is likely to
be due to the details of dendritic arborescence that are not captured
by the strong constraints of our dendritic model (symmetric branching,
diameter rules, number of branches, etc...). Despite those
discrepancies, size variations in our morphological model constitute a
reasonable first approximation to account for cellular variety within
the layer V pyramidal cell population.

This characterization, combined with the analytical tractability of
the model (see [[sec:Zin-measure]]) allow us to construct a map between
input resistance at the soma and size of the morphological model (the
passive properties are set as identical, the one fitted on the mean
impedance behavior). Thus, for each neuron in our previous "firing
response dataset", because we have its input resistance at the soma,
we can associate a given morphology. The association rule is shown in
Figure [[fig:in-vitro-calib]]C.

We now check what is the number of synapses obtained from the
combination of our fitted morpholgies with the physiological synaptic
densities. We found a mean number of synapses: 3953 \(\pm\) 1748 with
a ratio of excitatory to inhibitory numbers of synapses of 4.5 \(\pm\)
0.1. The fact that those numbers fall within the physiological range
offers a validation of our approach.

** An analytical approximation for the properties of the membrane potential fluctuations at the soma

#+ATTR_LATEX: :width \linewidth
#+NAME: fig:analytics-accuracy
#+CAPTION: *Accuracy of the analytical estimate for the properties of the membrane potential fluctuations at the soma: comparison between numerical simulations and the analytical approximation*. Shown for the medium size model of Figure [[fig:in-vitro-calib]]D. *(A)* In the numerical simulation, we explicitely simulate the whole dendritic arborization, we show the membrane potential variations for the three locations shown on the left. *(B)* Properties of the membrane potential fluctuations for different configuration of presynaptic activity: analytical predictions and output from numerical simulations in =NEURON=. In each column, one variable is varied while the other variables are fixed to the mean configuration value corresponding to \nu_e^p=\nu_e^d=0.2Hz, \nu_i^p=\nu_i^d=1.2Hz and s=0.05.
[[./figures/comparison_analytics_and_sim.png]]

For each cell, we now want to translate the five variables of the
model in terms of membrane potential fluctuations properties at the
soma (\mu_V, \sigma_V, \tau_V) on which we will apply the cell's
firing response function. To obtain a final map between the input (the
five model variables) and the output (the spiking probability).

Investigating dendritic integration for detailed morphological
structures is made difficult by the fact that this has to be done
numerically with a relatively high spatial and temporal
discretization. In the fluctuation-driven regime, one also needs to
sample over long times (T \gg \tau_V \sim 10ms) to obtain the
statistical properties of the somatic V_m resulting from dendritic
integration.  In addition, we have n=27 different morphologies in this
study and we will explore a five dimensional parameter space (the five
variable of our model). Under those conditions, if performed
numerically, the computational cost of such a study is clearly
prohibitive. We briefly describe here, why, in our simplified model,
an analytical treatment is nonetheless possible and thus render this
investigation feasible (see details in the Methods[[sec:strategy]] and in
the Supplementary Material). The key ingredient is the ability to
reduce the dendritic tree to an equivalent cylinder [[cite:Rall1962]], we
only adapted this reduction to the changes in membrane permeability
associated to the high conductance state [[cite:Destexhe2003]]. Two
approximations underlie our estimation: 1) the driving force during an
individual synaptic event is fixed to the level resulting from the
mean bombardment [[cite:Kuhn2004]] and 2) the effect at the soma of an
synaptic event at a distance \(x\) in a branch of generation \(b\),
corresponds to \(1/2^{b-1}\) the post-synaptic response to the
stimulation made of synchronous events at distance \(x\) in all the
\(2^{b-1}\) branches of the generation \(b\). Luckily, the combination
of those approximation is a favorable situation. Indeed, hypothesis 1)
overestimates the size of post-synaptic events (because the driving
force is not fixed, it diminishes during the PSP time course) while
hypothesis 2) underestimates the size of post-synaptic events (because
of the \(2^{b-1}-1\) synchronous events in neighboring branches, the
membrane conductance is higher than in the case of a single event,
consequently neighboring events have a shunting effect that
artificially descreases the response). In addition, both of those
approximation are likely to hold when single events are of low
amplitude compared to the amplitude of the massive synaptic
bombardment (see e.g.  [[citetext:Kuhn2004]] for the validity of the first
hypothesis).

In Figure [[fig:analytics-accuracy]], we compare the analytical
approximation to the output of numerical simulations performed with
the =NEURON= software [[cite:Hines1997]]. We varied the five variables of
the model around a mean synaptic bombardment configuration (see next
section). Some discrepancies between the approximation and the
simulations appeared, in particular one can see a \sim 1mV shift in
the standard deviation \sigma_V of the fluctuation. Because the
synchrony controls the amplitude of the fluctuations (Figure
[[fig:analytics-accuracy]]B and Figure [[fig:synaptic-integration]]B), the
analytical estimate could therefore be seen as an accurate estimate,
modulo a shift in the synchrony. Nonetheless, the trend in the
variations of the fluctuations as a function of the model variables is
globally kept between the analytical estimate and the numerical
simulations. This relatively good agreement therefore shows that our
analytical estimate is a valid tool to study dendritic integration in
the fluctuation-driven regime.

# We emphasize here that even if the analytical description uses the
# reduction to the equivalent cylinder (and therefore could be seen as
# equivalent to the Ball and Stick model), the described model has
# separate branches so that the fluctuations are uncorrelated from
# branches to branches unlike in the Ball and Stick model.

** Properties of the fluctuations for different types of presynaptic activity

We now implement various types of presynaptic activity and investigate
the properties of the resulting membrane potential fluctuations at the
soma. In addition, we represent the variations of the somatic input
conductance (relative to the leak input conductance) because, as it is
routinely measured in intracellular studies /in vivo/, this quantity
allows a comparison between the model and experimentally observed
activity levels. On Figure [[fig:synaptic-integration]], we present those
different protocols, on the left one can see how the five variables of
the model are comodulated for each protocol (color coded, see bottom
legend) and one the left, one can see the resulting properties of the
membrane potential fluctuations. We present those results only for the
medium-size model, but it was calculated for the morphologies
associated to all cells. The variability introduced by the various
morphologies is studied in the Supplementary Material and we found
that the qualitative behavior discussed in this section was preserved
in all cells.

#+ATTR_LATEX: :width .8\linewidth
#+NAME: fig:synaptic-integration
#+CAPTION: *Properties of the membrane potential fluctuations for different types of presynaptic activity: either unbalanced, purely proximal, purely distal, synchronized (color code)*. A common baseline configuration of low balanced proximal and distal activity gives rise to baseline fluctuations properties, then we increase a given type of activity. *(A)* Model variables to achieve varying levels of those different types of activity. *(B)* Membrane potential fluctuations properties and somatic input conductance at the soma for the different protocols. Shown for the medium-size model, see Supplementary Material for the variability introduced by variations in cell morphologies.
[[./figures/synaptic_integration.png]]

We first introduce a baseline level of presynaptic activity
corresponding to a low level of network activity: g_{tot}^{soma}/g_L
\sim 1.7, compared to \sim 3-4 in activated states, reviewed in
[[citetext:Destexhe2003]]. This baseline activity is a mix of proximal and
distal activity with a low degree of synchrony (s=0.05). Similarly to
[[cite:Kuhn2004]], the inhibitory activity is adjusted to obtain a balance
of the V_m fluctuations at -55mV. The firing values of this baseline
level are very low (\nu_e^d=\nu_e^p=0.2Hz for the excitation and
\nu_i^d=\nu_i^p=1.2Hz for the inhibition) in accordance with the
sparse activity characterizing mammalian neocortical dynamics
[[cite:Crochet2011,Peyrache2012]]. On top of this non-specific background
activity, we will now add a specific stimulation.

We start with unbalanced activity. We define it as a stimulation that
brings the mean membrane potential above -55mV corresponding to the
previously defined balance. The stimulation corresponds to an increase
of the excitatory synaptic activity (still running within a very
sparse range of activity, \(\nu_e^d=\nu_e^p \in [0.05, 0.5]\)Hz) with
an increasing inhibitory activity adjusted to linearly disrupt nthe
balance between -55mV and -52mV (see Figure
[[fig:synaptic-integration]]). The synchrony is kept constant and the
activity indifferentially raises in the proximal and distal part. This
increase of total activity raises the input conductance ratio close to
four. In this moderate range, the variations of the amplitude of the
fluctuations \sigma_V remains a monotonic increase (unlike the
non-monotonic variations found in the single-compartment study of
[[citetext:Kuhn2004]] and the case of a proximal stimulation, see below),
the fluctuations gets approximately twice faster (the normalized
autocorrelation time \tau_V/\tau_m^0 decays from 100% to 50%) and, of
course (by design), the mean depolarization has a linear increase of
3mV.

We now emulate purely proximal activity. To this purpose, we fix the
distal presynaptic firing frequencies (\nu_e^d and \nu_i^d) as well as
the synchrony to their baseline levels. To remain in a sparse activity
level, we increase the proximal excitatory activity from the baseline
level to 1.7Hz and we adjust proximal and somatic inhibitory activity
to keep the balance at the soma.  This would nonethless correspond to
large network activity level, as can be seen from the input
conductance ratio (that raises up to 8). This situation gives results
comparable to the single-compartment study of [[citetext:Kuhn2004]]. The
amplitude of the fluctuations has a non-monotonic profile and the
autocorrelation time strongly decreases. A notable difference is that,
even if we investigated high activity levels, the autocorrelation time
does not goes to zero and the amplitude of the fluctuations has only a
moderate decrease. This discrepancy is due to 1) the choice of
non-negligible synaptic time constants compared to the membrane time
constants (here \tau_{syn}=5ms and \tau_m^0 \sim 25ms, then
\tau_V/tau_m^0 would saturate at \tau_{syn}/tau_m^0 = 20%) and 2) the
fact that the synaptic input is distributed attenuates the strong
shunting effects observed in the single compartment case.

For distal activity, we keep the proximal presynaptic frequencies
(\nu_e^p and \nu_i^p) as well as the synchrony to their baseline
levels. We increase the distal excitatory activity from the baseline
level to a moderate level: 0.7Hz. The distal inhibitory frequency is
again adjusted to keep the balance at the soma. Here, we get a
different picture than in the proximal case, the increase in activity
leads to negligible increase of the somatic input conductance as
expected from electrotonically distant input
[[cite:Koch1990]]. Also, the decrease of the speed of the
fluctuations is much attenuated, the reason for this is that only the
distal part has a high conductance, consequently post-synaptic events
are strongly low-pass filtered by the proximal part of the
arborization before reaching the soma. Here, the amplitude of the
fluctuations strongly increases as a function of the input and do not
show the non-monotonic relation found for proximal input. This is
explain by the combination of the fact that 1) distal events are of
higher amplitude and 2) the shunting of post-synaptic events is much
reduced due to the relatively narrow localization of the synaptic
conductances.

Finally, we emulate an increase in the presynaptic synchrony. Here,
all synaptic frequencies are kept constant with respect to the
baseline level and we simply increase the probability of coincident
events for each synaptic spike train. Because there is no change in
synaptic activity, this stimulation does not affect the input
conductance ratio, neither the mean membrane potential or the speed of
the fluctuations. However, presynaptic synchrony strongly affects the
amplitude of the fluctuations in a near linear manner.

Note, that in addition to the sparse activity constraints or the
balance constraints, the criteria for the ranges of the model
variables was manually choosen to have the fluctuations in the same
domain. For example, we investigated a lower activity range for the
distal part than for the proximal part to avoid an explosion of
\sigma_V, the range for the synchrony increase follow the same
criteria.

We thus demonstrated here, that, in a theoretical model of dendritic
integration, the properties of the fluctuations (\mu_V, \sigma_V,
\tau_V) can follow various comodulations, depending on the properties
of the synaptic stimulation. This behavior is what motivated to fully
scan the three dimensional space (\mu_V, \sigma_V, \tau_V) in our
companion study.

** Heterogeneous firing responses induce diverse coupling to presynaptic activity

#+ATTR_LATEX: :width \linewidth
#+NAME: fig:cell-examples
#+CAPTION: *Examples of the firing response of 4 different cells for the different synaptic inputs (color-coded) shown in Figure [[fig:synaptic-integration]].* The abcissa corresponds to the variations of the model variables shown in Figure [[fig:synaptic-integration]]A
[[./figures/firing_response_examples.png]]

For each one of the n=27 cells of our companion study
[[cite:Zerlaut2016]], we now have 1) a morphological model and 2) a firing
response function \( \nu_{out} = \mathcal{F}(\mu_V, \sigma_V, \tau_V)
\). Thanks to the analytical approximation, we can translate the five
model variables \((\nu_e^p, \nu_i^p, \nu_e^d, \nu_i^d, s)\) into the
stationary fluctuations properties \((\mu_V, \sigma_V, \tau_V)\) that,
in turn, the firing response trsanslate into a spiking
probability. Thus, we finally get the full /input-output/ function
(within our theoretical framework) as illustrated on Figure
[[fig:model-illustration]]A.

We show on Figure [[fig:cell-examples]] the response of four cells to the
different types of presynaptic activity described in the previous
section. The responses show qualitative and quantitative differences,
we briefly discuss them here and we perform a more rigorous analysis
in the next section.

First, we can see that individual cells have a very different level of
response to the baseline level of synaptic activity (initial response
in Figure [[fig:cell-examples]]). Cell 1 has a baseline at \sim 10^{-2} Hz
while Cell2 or Cell3 have response above 1Hz, i.e. two orders of
magnitude above.

Importantly, those cells have different preferences for particular
types of stimulations. Cell 1 responds more to unbalanced activity
whereas Cell 2 and Cell 4 respond more to an increase in synchrony and
Cell 3 responds preferentially to proximal activity (within this
range). This is what we mean by /preferential coupling/: individual
neurons will respond preferentially to a particular type of synaptic
activity. An even more pronounced discrepancy appears for proximal
activity: the response can be either increased (Cell 1 and Cell 3) or
decreased (Cell 2 and Cell 4) with respect to the baseline level.

Given the relative invariance of the fluctuations properties for each
cell (see previous section, despite the various morphologies, the same
input creates the same fluctuations), those differences are the
consequences of the heterogeneity in the firing responses, we conclude
that /heterogeneous firing responses induce diverse coupling to
presynaptic activity/.

** Biophysical origin of the heterogenous couplings to presynaptic activities

#+ATTR_LATEX: :width \linewidth :float multicolumn
#+NAME: fig:coupling-correlation
#+CAPTION: *Diverse cellular responses to synaptic stimulation and their link to the chracteristics of their firing response function.* Note the logarithmic scale for the firing respones in *B,C,D*. *(A)* Diverse response to baseline stimulation. *(B)* Diverse response to unbalanced activity. *(C)* Diverse response to proximal activity. Note that because the response also show negative changes of firing rate, the data can not be log-scaled. Instead, they have been rescaled by the baseline response. *(D)* Diverse response to distal activity. *(E)* Diverse response to a synchrony increase.
[[./figures/coupling_correlations.png]]

We now make this analysis more quantitative by computing the responses
for all n=27 cells. We get their response to the baseline level
\nu_{bsl} and their mean response change for each stimulation type
(the mean over the range of scanned presynaptic input):
\delta\nu_{ubl} for the unbalanced activity, \delta\nu_{prox} for the
proximal activity, \delta\nu_{dist} for the distal activity and
\delta\nu_{synch} for an increased sychrony. We show the histogram of
those values in the left column of Figure [[fig:coupling-correlation]]. We
also look for the origin of the individual couplings by correlating
them with the characteristics of the neuronal firing responses
[[cite:Zerlaut2016]].

We first analyze the response to baseline activity \nu_{bsl}. When
log-scaled (Figure [[fig:coupling-correlation]]A), the distribution is
approximately normal and spans 2-3 orders of magnitude. This
log-normal distribution of pyramidal cell firing rates during
spontaneous activity seems to be a hallmark of mammalian neocortical
dynamics (see e.g. [[cite:Peyrache2012]] in human neocortex).  We
investigated what properties of the firing responses could explain
this behavior, we therefore looked for correlations between our
measures of the firing responses in the fluctuation-driven regime
[[cite:Zerlaut2016]] and the baseline responses. Not surprisingly, we
found a very strong linear correlation between the excitability
\langle V_{thre}^{eff}\rangle_D and the baseline response level, the
other characteristics semt to have no impact (Pearson correlations,
see values in Figure [[fig:coupling-correlation]]A). Again, it should be
stressed that presynaptic connections are non-specific, those results
therefore show that the typical log-normal distribution of firing
rates could very naturally emerge as a result of the normal
distribution observed in pyramidal cell's excitabilities
[[cite:Zerlaut2016]], thus suggesting that no specific circuitry is needed
to explain this neocortical property.

Despite the important differences in the fluctuations they create (see
Figure [[fig:synaptic-integration]]B), the responses over cells to
unbalanced activity, distal activity and an increased synchrony share
a very similar behavior. Their firing increases show a strong
heterogeneity over cells, covering two orders of magnitude (see log
y-axis on Figure [[fig:coupling-correlation]]B,D,E). This variability in
responses was again highly correlated with the
excitability. Surprisingly, the response was not dependent on any
other of the characteristics of the firing response. For example, the
variability observed during an increase in synchrony could have been
linked to the to the sensitivity to the standard deviation \sigma_V
\(\langle \partial \nu / \partial \sigma_V \rangle_\mathcal{D} \), but
this effect was not significant (p>0.05, Pearson correlation).  This
analysis therefore revealed that, for those type of synaptic
activities, those properties of the firing response have negligible
impact compared to the very strong effect of the variability in
excitabilities. In the Supplementary Material we also investigated
whether, after accounting for the variability due to the excitability,
the residual variability would be explained by the characteristics of
the firing response. Again, correlations were not significant,
suggesting that those quantities have a very low explanatory power on
the firing responses for those types of stimuli.

The response to proximal activity also showed a great variability but
with a qualitatively different behavior (Figure
[[fig:coupling-correlation]]C). Notably, firing could be suppressed or
increased. This variability was independent of the excitability of the
cells but was correlated with the sensitivity to the speed of the
fluctuations \(\langle \partial \nu / \partial \tau_V^N
\rangle_\mathcal{D} \). Indeed, the proximal stimulation implies a
strong variations of the fluctuations speed (i.e. decreasing \tau_V,
while keeping moderate variations of \sigma_V and, by design, a
constant \mu_V) thus rendering the sensitivity to the fluctuation
speed the critical quantity for this stimulation type.

* Discussion

In this communication, by introducing an analytically tractable
dendritic model, we presented the final form of our theoretical
framework for single cell computation in the fluctuation-driven
regime. We used it to investigate how the heterogeneity in firing
responses to fluctuating input shape the diverse input-output
functions of neocortical pyramidal cells. Focusing on the regime of
near asynchronous population dynamics, we emulated various type of
presynaptic activity in a theoretical model of dendritic
integration. We found that those different types of synaptic
stimulation corresponds to various comodulations of the fluctuations
properties, and that, because of their different response to the same
fluctuations, individual neurons would respond differently to those
stimulation.

The proposed theoretical framework for single-cell computation
nonetheless suffers from several weaknesses. First the dendritic
morphology is not so realistic, deviations from the symmetric
branching and Rall's branching rule can have a significant impact on
dendritic integration. Most importantly, there is no active mechanisms
in dendrites (see [[citetext:London2005]] for a review). Future work
should try to implement dendritic non-linearities within this
framework. Also it only enables to investigate dendritic integration
in a context where information is processed through population rate
[[cite:Shadlen1994]] and where it can be converted into temporal
modulations of the membrane potential fluctuations. Future work could
also investigate an extension yoward a /temporal coding/
scheme. Because the core of the analytical calculus comes from an
event-based strategy, this is theoretically feasible. 

Despite those weaknesses, we believe that having an analytical model
for dendritic integration in the fluctuation-driven regime is a useful
tool for many problems in theoretical neuroscience. The main advantage
of this model is that you can very naturally plug in physiological
parameters (because surface area is physiological as well as transfer
resistance to soma) and still it remains analytical (though see
deviations of the approximations in Figure [[fig:analytics-accuracy]]). In
the field of neural network dynamics, the literature is exclusively
based on the reduction to the single-compartment. Though being
approximative, our framework thus opens the path toward an analysis of
recurrent networks (see [[citetext:Renart2004]] for a review) for extended
dendritic structures.

Very naturally, a key quantity to explain the various neuronal
responses was the cellular excitability. Indeed, the response to
unbalanced activity, distal activity or an increase in synchrony was
strongly correlated with cellular excitability. Also the sensitivity
to the speed of the fluctuations had a crucial impact on the response
to proximal activity. The present analysis therefore shed light on the
physiological relevance of the properties that we introduced in our
companion study. In all four measures characterizing the cellular
properties in the fluctuation-driven regime that we introduced in our
companion study, only two of them seems to be physiologically
relevant: the excitability and the sensitivity to the speed of the
fluctuations (at least for the protocols that we tested). In our
companion communication, theoretical modeling suggested that a high
sensitivity to the speed of the fluctuations was enable by a high
level of sodium inactivation. The present analysis thus proposes a
functional role for sodium inactivation: controlling the response
level to proximal activity.


In this study, the rescaling rule between input resistance at the soma
and the size of the morphological model has led to the invariance in
the relation between input (presynaptic variables) and the fluctuation
properties. Thus the heterogeneity in morpholgies (here only cell
sizes) had very little effects on the heterogeneity of cell
responses. The variability in responses could only come from the
various firing response functions. This confirms that we achieved a
situation where the /circuit specificity/ was null and responses
varied because of various /biophysical specificities/.


We emphasize here that the introduction of the /biophysical
specificity/ is a /refinment/ to explain the response of individual
neurons. In response to a given stimulus, the /circuit specificity/
relative to this stimulus will be the main contributor to the
response. Taking back the example of the mice somato-sensory study of
[[citetext:Crochet2011]], active touch can elicit depolarizations in a
\(sim\) 20mV range (from no depolarization to a 20mV depolarization)
while action potential threshold spans a \(sim\) 5mV range (see Figure
5D in [[citetext:Crochet2011]]). Thus there is a factor about 4 between
the /circuit specificity/ (how much one neuron will be depolarized in
response to active touch) and its /biophysical specificity/ (its
action potential threshold). Nnote that we employed the term
depolarization term to simplify the discussion, this actually
corresponds to a reached level of membrane potential \(V_{rev}\), see
[[citetext:Crochet2011]].

We now speculate about a putative link between a recent observation
and the present findings. The /in vivo/ study in mice visual cortex of
[[citetext:Okun2015]] reported a strong heterogeneity in the coupling
between individual cell's responses and the locally recorded
population activity. The authors explained those observations by a
variabiliy in the local recurrent connectivity and argued that this
diverse coupling did not seem to be explained by biophysical
heterogeneity (e.g. the coupling was independent from the action
potential threshold, somehow a measure of the excitability). However,
as local connectivity is thought to target more proximal regions
[[cite:Spruston2008]], our study proposes a biophysical mechanism that
could contribute to their observation.  The diverse coupling to
proximal activity was explained by the sensitivity to the speed of the
fluctuations, and similarly to their results, this coupling was found
to be independent on the cellular excitability (see Figure
[[fig:coupling-correlation]]). Note that two strong hypothesis underlie
the previous reasoning: 1) that local population activity correspond
to the proximal activity modeled our study, i.e. the activity should
remains balanced, elicits strong changes in the speed of the
fluctuations while limiting variations of \sigma_V and 2) that the
biophysical heterogeneity for the sensitivity to \tau_V observed in
young mice cortex is at least partially preserved in adult animals.
Future work could therefore adress this hypothesis by combining
recordings of population activity with a more subtle and
functionnally-relevant analysis of single cell properties (analogous
to that of our companion communication).

* Material and Methods 
\small

** Morphological model
<<sec:morphology>>

The morphology of our theoretical model is the following (depicted in
Figure [[fig:model-illustration]]B): it is made of an isopotential somatic
compartment (i.e. a leaky RC circuit) in parallel with a dendritic
structure. The dendritic tree is an arborization of total length L_t
containing B generation of branches. For simplicity all branches of a
generation \( b \in [1, B]\) have a length L_t/B. From one generation
to the other, a branch divides into two branches where the diameter of
the daughter branches follows Rall's 3/2 branching rule [[cite:Rall1962]]:
\( (d_{b+1})^{\frac{3}{2}} = (d_{b})^{\frac{3}{2}} /2 \), i.e. \( d_b
= 2^{-\frac{2}{3}} d_t \) where d_t in the diameter of the root branch
of the dendritic tree.

The parameters of the model are presented on Table [[table:params]].

#+ATTR_LATEX: :float multicolumn
#+NAME: table:params
#+CAPTION: *Model parameters*. The passive properties and the mean morphology are fitted while 
| *Parameters*      | Parameter Name                | Symbol                 | Value | Unit                      |
|-------------------+-------------------------------+------------------------+-------+---------------------------|
| /                 | <>                            | <>                     |    <> | /                         |
|                   |                               |                        |       |                           |
| *passive*         |                               |                        |       |                           |
|                   | leak resistivity density      | \(r_m\)                |   325 | \(\mu\)S/cm^2             |
|                   | intracellular resistivity     | \(r_i\)                |    30 | \Omega .cm                |
|                   | specific capacitance          | \(c_m\)                |  1.05 | \(\mu\)F/cm^2             |
|                   | leak reversal potential       | E_L                    |   -65 | mV                        |
| *synaptic*        |                               |                        |       |                           |
|                   | inhibitory reversal potential | E_i                    |   -80 | mV                        |
|                   | excitatory reversal potential | E_e                    |     0 | mV                        |
|                   | somatic excitatory density    | $\mathcal{D}_e^{soma}$ |     0 | synapses/(100\(\mu\)m^2) |
|                   | somatic inhibitory density    | $\mathcal{D}_i^{soma}$ |    20 | synapses/(100\(\mu\)m^2) |
|                   | tree excitatory density       | $\mathcal{D}_e^{tree}$ |    30 | synapses/(100\(\mu\)m^2) |
|                   | tree inhibitory density       | $\mathcal{D}_i^{tree}$ |     6 | synapses/(100\(\mu\)m^2) |
|                   | prox. excitatory weight       | Q_e^{0,p}              |   0.7 | nS                        |
|                   | prox. inhibitory weight       | Q_i^{0,p}              |    1. | nS                        |
|                   | distal excitatory weight      | Q_e^{0,d}              |  1.05 | nS                        |
|                   | distal inhibitory weight      | Q_i^{0,d}              |   1.5 | nS                        |
|                   | excitatory decay              | \tau_e                 |     5 | ms                        |
|                   | inhibitory decay              | \tau_i                 |     5 | ms                        |
| *Mean morphology* |                               |                        |       |                           |
|                   | soma length                   | L_S                    |   5.0 | \(\mu\)m                  |
|                   | soma diameter                 | D_S                    |  15.0 | \(\mu\)m                  |
|                   | root branch diameter          | D_t                    |  2.25 | \(\mu\)m                  |
|                   | tree length                   | L_t                    | 550.0 | \(\mu\)m                  |
|                   | branch number                 | B                      |     5 |                           |
|                   | Proximal tree fraction        | f_{prox}               |   7/8 |                           |

** Model equations: synaptic input and passive properties
<<sec:model-equations>>

The cable equation describes the temporal evolution and spatial spread
of the membrane potential along the branches of the dendritic tree
[[cite:Rall1962]]:

#+NAME: eq:cable
\begin{equation}
\frac{1}{r_i} \frac{\partial^2 v}{\partial x^2} = i_m(v, x, t) = c_m \frac{\partial v}{\partial t} + \frac{v-E_L}{r_m} - i_{syn}(v,x,t)
\end{equation}

the membrane current $i_m(v, x, t)$ is a linear density of current
(the presented cable equation already includes the radial
symmetry). Though the modeled system has several branches, the
equation can be written as a single spatial dependency $x$ because the
symmetry of the model across branches imply that the properties of the
input are identical at a given distance to the soma.

Synaptic input is modeled by local (infinitely small) and transient
changes of membrane permeability to selective ionic channels. Both
excitatory (accounting for AMPA synapses) and inhibitory synapses
(accounting for GABAa synapses) are considered, their reversal
potential is E_e=0mV and E_i=-80mV respectively. Each synaptic event
is generated by a shotnoise and its effect on the conductance is a
jump followed by an exponential decay. The form of the synaptic
current is therefore:

#+NAME: eq:synaptic-currents
\begin{equation}
\left\{
\begin{split}
& i_{syn}(v,x,t) = g_e(x,t)(E_e-v)+g_i(x,t)(E_i-v) \\
& g_e(x,t) = \sum_{\big\{x_e, \{t_e\} \big\}} \delta(x-x_e) \sum_{t_e} \mathcal{H}(t-t_e) Q_e(x) \, e^{-\frac{t-t_e}{\tau_e}} \\
& g_i(x,t) = \sum_{\big\{x_i, \{t_i\} \big\}} \delta(x-x_i) \sum_{t_i} \mathcal{H}(t-t_i) Q_i(x) \, e^{-\frac{t-t_i}{\tau_i}}\\
\end{split}
\right.
\end{equation}

where $g_e$ and $g_i$ are linear densities of conductances. Each
synapse, indexed by $s$, has a position $x_s$ and a set of presynaptic
events \(\{t_s\}\), hence the iteration over \( \big\{x_s, \{t_s\}
\big\} \) for the sum over synapses for each synaptic
type. $\mathcal{H}$ is the Heaviside step function. The presynaptic
events $\{t_s\}$ are generated by point processes at fixed frequencies
$\nu_s$ with a given degree of synchrony, see details in the next
section[[sec:presyn-point-process]].

The model distinguishes two domains : a proximal domain with the upper
index $p$ and a distal domain with the upper index $d$ (see Figure
[[fig:model-illustration]]). Then the space-dependent quantities
(presynaptic frequencies, synaptic quantal and synaptic decay time
constant) can be written as :

#+NAME: eq:space-dep-quant
\begin{equation}
\left\{
\begin{split}
& \nu_e(x) = \nu_e^P + (\nu_e^d - \nu_e^p) \mathcal{H}(x-l_p)\\
&\nu_i(x) = \nu_i^P + (\nu_i^d - \nu_i^p) \mathcal{H}(x-l_p) \\
& Q_e(x) = Q_e^P + (Q_e^d - Q_e^p) \mathcal{H}(x-l_p)\\
& Q_i(x) = Q_i^P + (Q_i^d - Q_i^p) \mathcal{H}(x-l_p) \\
\end{split}
\right.
\end{equation}

The continuity of the membrane potential and of the current at the
boundaries between the proximal and distal part imply:

\begin{equation}
\left\{
\begin{split}
& v(l_p^-,t) = v(l_p^+,t) \\
& \frac{1}{r_i} \frac{\partial v}{\partial x}_{l_p^-} 
= \frac{1}{r_i} \frac{\partial v}{\partial x}_{l_p^+} 
\end{split}
\right.
\end{equation}

where the limit with upper index $\pm$ indicate the limit taken from
the left or the right respectively.

At the soma, $(x=0)$, we have a lumped impedance compartment. It has
leaky RC circuit properties and also receives synaptic inhibition, the
somatic membrane potential therefore follows :

\begin{equation}
\left\{
\begin{split}
& C_M \frac{dV}{dt} + \frac{V-E_L}{R_M} + G_I(t) \, (V-E_i)  + I(t) = 0 \\
& G_i(t) = \sum_{N_i} \sum_{\{t_i\}} Q_i^p \, e^{-\frac{-(t-t_i)}{\tau_i^p}} \, \mathcal{H}(t-t_i)
\end{split}
\right.
\end{equation}

where $I(t)$ is the time-dependent input current from the soma into
the dendrite. $R_M$ and $C_M$ are the RC properties of the lumped
compartment (capital letters will indicate the somatic properties
throughout the calculus). $N_i$ is the number of somatic synapses,
each of them generates a point process $\{t_i\}$ of inhibitory
synaptic events. The properties of the somatic synapses $(\nu_i^S,
Q_i^S)$ are equivalent to the proximal ones.

This equation with the membrane potential continuity will determine
the boundary condition at the soma (x=0). We identify $V(t)=v(0,t)$,
then $I(t)$ is the current input into the dendritic tree at $x=0$ so
it verifies:

\begin{equation}
\frac{\partial v}{\partial x}_{|x=0}} = - r_i \, I(t)
\end{equation}

So:
#+NAME: eq:soma-bound
\begin{equation}
\frac{\partial v}{\partial x}_{|x=0} = r_i \, 
\Big( C_M \frac{\partial v}{\partial t}_{|x=0} + \frac{v(0,t)-E_L}{R_m} + G_I(t) \, ( v(0,t)-E_i) \Big)
\end{equation}

Finally, the last boundary condition is that all branches terminate with an infinite resistance that impede current flow (sealed-end boundary conditions):

#+NAME: eq:end-bound
\begin{equation}
\frac{\partial v}{\partial x}_{x=l} = 0
\end{equation}

Together with the biased Poisson process for event generation (see
the next section[[sec:presyn-point-process]]), the final set of equations
that describes the model, is therefore:

#+NAME: eq:model-equation
\begin{equation}
\left\{
\begin{split}
& \frac{1}{r_i} \frac{\partial^2 v}{\partial x^2} = 
c_m \frac{\partial v}{\partial t} + \frac{v-E_L}{r_m} - i_{syn}(v,x,t)\\
& \frac{\partial v}{\partial x}_{|x=0} = r_i \, 
\Big( C_M \frac{\partial v}{\partial t}_{|x=0} + \\
& \qquad \qquad \frac{v(0,t)-E_L}{R_m} + G_I(t) \, ( v(0,t)-E_i) \Big) \\
& v(l_p^-,t) = v(l_p^+,t) \\
& \frac{\partial v}{\partial x}_{l_p^-} 
= \frac{\partial v}{\partial x}_{l_p^+} \\
& \frac{\partial v}{\partial x}_{x=l} = 0
\end{split}
\right.
\end{equation}

** Model of presynaptic activity
<<sec:presyn-point-process>>

Presynaptic activity is modelled as a discrete set of presynaptic
events. Because of the apparent random spiking activity in the
fluctuation-driven regime, the basis for the generation of those
discrete events is the Poisson process. Nonetheless, we want to
reproduce the additional degree of presynaptic synchrony found in
neocortical asssemblies that result mainly for two phenomena: 1)
pairwise correlation between neurons and 2) muti-innervation of a cell
by a presynaptic neuron. We therefore introduce a variable \(s\) that
will bias the event generation of the Poisson process (\(s \in
[0,1]\)). For simplicity in the analytical treatment, synchrony in
presynaptic activity is not shared across different synapses. We
arbitrarily limit the number of coincident events to four events,
therefore for a degree of synchrony \(s\): single events have a
probability \(1-s\), double events have a probability \(s-s^2\),
triple events events have a probability \(s^2-s^3\) and quadruple
events have a probability \(s^3\). To generate a biased Poisson
process of frequency \(\nu\) with a degree of synchrony \(s\), we
therefore generate a Poisson process of frequency:

#+NAME: eq:new-freq-with-correl
\begin{equation}
\nu_{synch} = \frac{\nu}{1+s+s^2+s^3}
\end{equation}

and we duplicate (from up to four events) each event according to
their probabilities of occurence.

This is a very simplistic and limited model of presynaptic synchrony
but it is sufficient for reproducing the impact of synchrony on the
quantities investigated in this paper (only the variance of the
membrane potential fluctuations).

** Numerical implementation
<<numerical-implementation>>

The full model has been implemented numerically using the =NEURON=
software. The branched morhology was created and passive cable
properties were introduced (see Table [[table:params]]). The spatial
discretization was =nseg=30= segments per branch. On each segment, one
excitatory and one inhibitory synapse were created, the shotnoise

frequency was then scaled according to the segment area and the
synaptic density to account for the number of synapses on this segment
(using the properties of the Poisson process, N synapses at frequency
$\nu$ is a synapse at frequency $N\nu$). Custom event generation was
implemented to introduce correlations (instead of classical =NetStim=)
and fed =NetCon= objects attached to each synapses (=ExpSyn=
synapses). Each simulation had a time step dt=0.01ms and a length of
10s, the simulation was repeated over 4 seeds to yield a mean and a
standard deviation in the estimate of the membrane potential
fluctuations at the soma (see Figure [[fig:analytics-accuracy]]B).

** Analytical derivation of the fluctuation properties: strategy
<<sec:strategy>>

We present here a derivation that provides an analytical approximation
for the properties of the fluctuations of the membrane potential at
the soma for our model. Summing up its properties, we get: 1) a
morphology with a lumped somatic compartement and a dendritic tree of
symmetric branching following Rall's rule 2) conductance-based
synapses 3) independent excitatory and inhibitory shotnoise input
spread all over the morphology 4) assymetric properties between a
proximal part and a distal part and 5) a certain degree of synchrony
in the pre-synaptic spikes.

The properties of the membrane potential fluctuations at the soma
correspond to three stationary statistical properties of the
fluctuations: their mean $\mu_V$, their standard deviation
\(\sigma_V\) and their /global/ autocorrelation time
\(\tau_V\). Following [[citetext:Zerlaut2016]], we emphasize that the
/global/ autocorrelation time is a partial description of the
autocorrelation function (as the autocorrelation function is not
exponential) but it constitutes the first order description of the
temporal dynamics of the fluctuations.

A commonly adopted strategy in the /fluctuation-driven/ regime to
obtain statistical properties is to use stochastic calculus after
having performed the /diffusion approximation/, i.e. approximating the
synaptic conductance time course by a stochastic process, see
e.g. [[cite:Tuckwell2002]]). This approach is nonetheless not easily
generalizable to conductance input in an extended structure and render
the inclusion of assymetric properties (proximal vs distal)
complicated. We rather propose here an approach that combines
simplifying assumptions and analytical results from shotnoise theory,
it constitutes an extension of the approach proposed in
[[citetext:Kuhn2004]].

For each set of synaptic stimulation \(\{\nu^e_p, \nu_i^p, \nu_e^d,
\nu_i^d, s\}\), the derivation corresponds to the following steps:

- We transform the dendritic structure to its equivalent cylinder. The
  reduction to the equivalent cylinder is "activity-dependent" and
  captures the changes in membrane properties that results from the
  mean synaptic conductance levels.

- We derive a mean membrane potential \(\mu_V(x)\) corresponding to
  the stationary response to constant densities of conductances given
  by the means of the synaptic stimulation. We use this
  space-dependent membrane potential \(\mu_V(x)\) to fix the driving
  force all along the membrane for all synapses. The relation between
  synaptic events and the membrane potential now becomes linear.

- We derive a new cable equation that describes the variations of the
  membrane potential around this $\mu_V(x)$ solution. 

- We calculate the effect of one synaptic event on a branch \(b, b\in
  [1,B]\) at a distance $x$. We calculate the post-synaptic membrane
  potential event \($PSP_b(x,t)\) at the soma resulting from $b$
  synchronous synaptic events occuring at the distance $x$ from the
  soma. We approximate the effect of only one event by rescaling the
  response by the number of input \($PSP_b(x,t)/b\).

- We use shotnoise theory to compute the power spectrum density of the
  membrane potential fluctuations resulting from all excitatory and
  inhibitory synaptic events (including the synchrony between events).

The full derivation has been conducted with the help of the python
modulus for symbolic computation: =sympy= (deriving homogenous
solutions is relatively simple but computing coefficients with the
boudaries conditions give rise to complex expressions because of the
number of parameters). The resulting expression were then exported to
=numpy= functions for numerical evaluation. The =ipython= notebook
that presents the full derivation is available on the following [[http://nbviewer.jupyter.org/urls/bitbucket.org/yzerlaut/diverse_coupling_to_synaptic_activity/raw/master/notebooks/Fluctuations_at_soma_for_Ball_&_Rall_tree.ipynb][link]].

** From fluctuation properties to spiking probability

How layer V pyramidal neurons translate membrane potential
fluctuations into a firing rate response was the focus of our previous
communication, see [[citetext:Zerlaut2016]]. We re-use here the same
dataset. Note that in the main text, we removed the n=4 cells that had
too low or too high excitabilities firing rates, as it is hard to
conduct an analysis on 7 orders of magnitudes from \(\nu \in [10^{-5},
10^{2}]\)Hz (especially for data visualization). This reduction
reduced the output variations to \(\nu \in [10^{-1}, 10^{1}]\)Hz. In
the supplementary material, we reintroduce the discarded cells to show
that they do not affect the results of the main text.

** Experimental preparation and electrophysiological recordings
<<sec:exp-prep>>

Experiments were performed at Unité de Neurosciences, Information et
Complexité, Gif sur Yvette, France. Experimental procedures with
animals were performed following the instructions of the European
Council Directive 2010 86/609/EEC and its French transposition (Décret
2013/118). Experimental methods were identical to those presented in
[[citetext:Zerlaut2016]]. Very briefly, we performed intracellular
recordings in the current-clamp mode using the perforated patch
technique on layer V pyramidal neurons of coronal slices of juvenile
mice primary visual cortex. For the n=13 cells presented in this
study, the access resistance R_S was 13.3M\(\Omega\) \(\pm\)5.4, the
leak current at -75mV was -25.7pA \(\pm\)17.3, cells had an input
resistance R_m of 387.3M$\Omega$ \(\pm\)197.2 and a membrane time
constant at rest of 32.4ms \(\pm\)23.1.

** Input impedance characterization
<<sec:Zin-measure>>

 To determine the input impedance at the soma, we injected sinusoidal
 currents in the current-clamp mode of the amplifier (Multiclamp 700B,
 Molecular Devices), we recorded the membrane potential response to a
 current input of the form \(I(t)=I \, \sin(2\pi \, f \, t) \), we
 varied the frequencies $f$ and amplitudes $I over 40 episodes per
 cell. The frequency range scanned was [0.1, 500] Hz. For each cell,
 we determined manually the current amplitude $I_0$ that gave a \sim
 5mV amplitude in a current step protocol, from this value, the value
 of $I$ was scaled exponentially between $I_0$ at 0.1 Hz and \(50
 I_0\) at 500Hz. The reason for varying the current amplitude (and not
 only the oscillation frequency) in those input impedance protocols is
 to anticipate for the low pass filtering of the membrane and insure
 that the membrane potential response at high frequencies is far above
 the electronic noise level (\sim 0.1 mV).

After removing the first 3 periods of the oscillations (to avoid
transient effects), we fitted the membrane potential response to the
form:

\begin{equation}
V(t) = E_L + R \, I \, \sin(2\pi \, f \, t - \phi)
\end{equation}

where \(E_L, R\) and $\phi$ were fitted with a least-square
minimization procedure. The frequency dependent values of $R$ and
$\phi$ give the modulus and phase shift of the input impedance
presented in Figure [[fig:in-vitro-calib]]A.

** Fitting passive properties and a mean morphology
<<sec:fitting>>

Because the variables combined discrete (the branch number) and
continuous variables, the minimization consisted in taking the minimum
over a grid of paramters. The parameter space has 7 dimensions (given
here with the considered range): the branch number (B \in [2, 7]), the
somatic length (L_S \in [5, 20]\(\mu\)m), the total length of the tree
(L_t \in [300, 800]\(\mu\)m), the diameter of the root branch (D_t \in
[0.5, 4]\(\mu\)m), the leak specific resistance (r_m \in [100,
1000]\(\mu\)S/cm^2), the intracellular resistivity (r_i \in [10,
90]\(\Omega\).cm), the specific capacitance (c_m \in [0.8,
1.8]\(\mu\)F/cm^2).

Each dimension was discretized in 5 points, the scan of the 7
dimensional space then consisted in finding the least square residual
of the product of the modulus and phase of the impedance over this 5^7
points. The resulting parameters are shown on Table [[table:params]].

* Supplementary information

** Supplementary material

Supplementary material contains the detailed mathematical derivation
of the membrane potential fluctuations

** Acknowledgments

We would like to thank Gilles Ouanounou for his help during
electrophysiological recordings and Gérard Sadoc for assistance with
the acquisistion software. We also thank Manon Richard and Aurélie
Daret for animal facilities.

** Funding

Y.Z was supported by fellowships from the Initiative d'Excellence
Paris-Saclay and the Fondation pour la Recherche Médicale (FDT
20150532751). Research funded by the CNRS and the European Community
(BrainScales FP7-269921 and the Human Brain Project FP7-604102 to
A.D.). The authors declare no competing financial interests.

** Author contributions :noexport:

Y.Z. and A.D. designed research. Y.Z performed research and wrote the
present draft.

* References
\bibliography{tex/biblio}

