#+TITLE: Do heterogenous firing responses lead to diverse couplings to presynaptic activity ?
# A theoretical study in a simplified morphological model of layer V pyramidal neurons
#+AUTHOR: Y. Zerlaut^{1} \& A. Destexhe^{1}
#+INCLUDE: my_template_draft.org 

* Abstract

  \bfseries

  Neocortical processing of sensory input rely on the specific
  activation of subpopulations within the cortical network. Though
  specific circuitry is thought to be the primary mechanism underlying
  this functional principle, we investigate here how diverse
  biophysical features in single neuron might contribute to such
  differential activation.

  In a companion study [[cite:Zerlaut2016]], we reported that, in young
  mice visual cortex, individual neurons differ not only in their
  excitability but also in their sensitivities to the properties of
  the membrane potential fluctuations. In the present work, we analyze
  how this heterogeneity is translated into diverse input-ouput
  properties (i.e. in the relation from presynaptic quantities to
  spiking probability). To this purpose, we designed a simplified
  morphological model of layer V pyramidal neurons with a dendritic
  tree following Rall's branching rule. We first show that we are able
  to calibrate this simplified model on /in vitro/ measurements of
  somatic input impedance. We then propose an analytical derivation
  for the membrane potential fluctuations at the soma as a function of
  the properties of the synaptic bombardment. This mathematical
  description allows to easily emulate various forms of presynaptic
  activities: either balanced, unbalanced, synchronized, purely
  proximal or purely distal synaptic activity. We found that those
  different forms of activity led to various comodulations of the
  membrane potential fluctuation properties, thus raising the question
  whether individual neurons might differentially couple to specific
  forms of activity because of their various firing responses to
  fluctuations [[cite:Zerlaut2016]]. We indeed found such an heterogenous
  response, but trivially, the only significant contribution to the
  various firing response was the different levels of cellular
  excitability (linked to the action potential threshold level). A
  notable exception appeared for proximal activity: increasing
  proximal activity could either promote firing response in some cells
  or suppress it in some other cells whatever their individual
  excitability. This behavior could only be explained by various
  sensitivities to the speed of the fluctuations, that was previously
  linked to heterogenous levels of sodium inactivation and sodium
  channels density.

  In addition to giving quantitative insight on the impact of various
  excitability levels in individual neurons, the present study
  suggests a new functional impact of biophysical heterogeneity:
  various levels of density of sodium channels and sodium inactivation
  will control the response of individual neurons to proximal
  activity.

\normalfont

* Introduction

Neocortical processing of sensory input rely on the specific
activation of subpopulations within the cortical network. The details
of how such specific activations happens are key questions in systems
neuroscience.
# Though this diverse activation is likely to be due to specific
# connectivity schemes, we explore here a complementary mechanism: given

Neocortical neurons differ in their afferent connectivity. For
example, in the somato-sensory cortex of rodents, layer IV neurons in
two different barrels sample inputs from different locations in the
thalamus nucleus [[ref?]]. Neocortical neurons also vary in their
electrophysiological properties. For example, heterogenous levels in
the action potential threshold are routinely measured both in vivo
[[Nowak, etc]] and in vitro [[refs]]. An emerging picture is that the
sensitivity of a neuron to a given feature results from the
combination of its /circuit specificity/ (relative to this feature)
and its /biophysical specificity/.  The somato-sensory cortex study of
[[citetext:Crochet2011]] illustrates this point precisely.  During active
touch, the response probability of a neuron (its sensitivity to
whisker touch) follows from the combination of the reached level of
synaptically-driven membrane potential deflection (resulting from its
/circuit-specificity/) and its threshold for action potential
triggering (its /biophysical specificity/). The same result hold for
texture recognition in the study of [[citetext:Yang2015]] where the
combination of the two mentionned effect correlated with the [[xx, to be
checked]] in barrel cortex neurons.

# Therefore highlighting the role of the interaction between circuit
# afference and biophysics for stimulus representation at the single
# neuron level in sensory cortex.

In the present work, we investigate such interactions in the light of
the variability in the biophysical features reported in
[[citetext:Zerlaut2016]], namely that single neurons in juvenile mice
cortex not only vary in their excitability (linked to the action
potential threshold) but also in their sensitivity to the properties
of the membrane potential fluctuations. Our previous communication
introduced new dimensions in the /biophysical specificity/ and we now
aim at understanding their functional impact.

[[crucial part]] We investigate such interactions in the context of
population dynamics, where the neuronal response can be described as a
spiking probability and the input can be described by stationary
firing rates (or slowly modulated firing rates compared to the
membrane time constant).


We thus designed a theoretical model for passive dendritic integration
that allows an analytical treatment and thus easily enables the
implementation of various types of presynaptic activity. It is based
on a symmetrical morphology where branching follows the Rall's 3/2
exponent rule [[cite:Rall1962]], the analytical derivation relies on
adapting the equivalent cylinder transformation [[cite:Rall1962]] to the
properties of the high conductance state [[cite:Destexhe2003]].

We implemented various types of presynaptic activity: either
unbalanced, purely proximal, purely distal or synchronized. We found
that those various types of activity corrresponds to different
variations of the properties of the membrane potential fluctuations
(mean depolarization, standard deviation and autocorrelation
time). The various firing responses (as a function of the fluctuation
properties) for individual neurons found in our companion study then
led to diverse coupling to each activity type. 

# Taken together, our two studies suggest that [...]

# Though this diverse activation is likely to be due to specific
# connectivity schemes, we explore here a complementary mechanism: given
# the strong heterogeneity in electrophysiological properties of
# neocortical pyramidal cells
# [[citetext:Yang2015]] suggested that stimulus representation in barrel
# cortex is linked to the combination of circuit factors (the precise
# connectivity will likely determine the amplitude of the V_m
# deflections) and biophysical factors (the threshold
# value). Biophysical parameters are thus a key properties of 

* Material and Methods 
\small

** Morphological model
<<sec:morphology>>

The morphology of our theoretical model is the following (depicted in
Figure [[fig:model-illustration]]B): it is made of an isopotential somatic
compartment (i.e. a leaky RC circuit) in parallel with a dendritic
structure. The dendritic tree is an arborization of total length L_t
containing B generation of branches. For simplicity all branches of a
generation \( b \in [1, B]\) have a length L_t/B. From one generation
to the other, a branch divides into two branches where the diameter of
the daughter branches follows Rall's 3/2 branching rule [[cite:Rall1962]]:
\( (d_{b+1})^{\frac{3}{2}} = (d_{b})^{\frac{3}{2}} /2 \), i.e. d_b =
2^{-\frac{2}{3}} d_t \) where d_t in the diameter of the root branch
of the dendritic tree.

The parameters of the model are presented on Table [[table:params]].

#+ATTR_LATEX: :float multicolumn
#+NAME: table:params
#+CAPTION: *Model parameters* 
| *Parameters*      | Parameter Name                | Symbol                 | Value | Unit                      |
|-------------------+-------------------------------+------------------------+-------+---------------------------|
| /                 | <>                            | <>                     |    <> | /                         |
|                   |                               |                        |       |                           |
| *passive*         |                               |                        |       |                           |
|                   | leak resistivity density      | \(r_m\)                |  10.0 | mS/cm^2                   |
|                   | specific capacitance          | \(c_m\)                |  1.05 | \mu F /cm^2               |
|                   | leak reversal potential       | E_L                    |   -65 | mV                        |
| *synaptic*        |                               |                        |       |                           |
|                   | inhibitory reversal potential | E_i                    |   -80 | mV                        |
|                   | excitatory reversal potential | E_e                    |     0 | mV                        |
|                   | somatic inhibitory density    | $\mathcal{D}_i^{soma}$ |    20 | synapses/(100$\mu m^{2}$) |
|                   | tree excitatory density       | $\mathcal{D}_e$        |    30 | synapses/(100$\mu m^{2}$) |
|                   | tree inhibitory density       | $\mathcal{D}_i$        |     8 | synapses/(100$\mu m^{2}$) |
|                   | prox. excitatory weight       | Q_e^{0,p}              |   1.0 | nS                        |
|                   | prox. inhibitory weight       | Q_i^{0,p}              |   1.2 | nS                        |
|                   | distal excitatory weight      | Q_e^{0,d}              |   1.0 | nS                        |
|                   | distal inhibitory weight      | Q_i^{0,d}              |   1.2 | nS                        |
|                   | excitatory decay              | \tau_e                 |     4 | ms                        |
|                   | inhibitory decay              | \tau_i                 |   1.2 | ms                        |
| *Mean morphology* |                               |                        |       |                           |
|                   | soma diameter                 | D_S                    |  15.0 | \(\mu\)m                  |
|                   | soma length                   | L_S                    |  10.0 | \(\mu\)m                  |
|                   | root branch diameter          | D_t                    |  15.0 | \(\mu\)m                  |
|                   | tree length                   | L_t                    |  15.0 | \(\mu\)m                  |
|                   | branch number                 | B                      |     5 |                           |
|                   | Proximal tree fraction        | f_{prox}               |   5/6 |                           |

** Model equations: synaptic input and passive properties
<<sec:model-equations>>

The cable equation describes the temporal evolution and spatial spread
of the membrane potential along the branches of the dendritic tree
[[cite:Rall1962]]:

#+NAME: eq:cable
\begin{equation}
\frac{1}{r_i} \frac{\partial^2 v}{\partial x^2} = i_m(v, x, t) = c_m \frac{\partial v}{\partial t} + \frac{v-E_L}{r_m} - i_{syn}(v,x,t)
\end{equation}

the membrane current $i_m(v, x, t)$ is a linear density of current
(the presented cable equation already includes the radial
symmetry). Though the modeled system has several branches, the
equation can be written as a single spatial dependency $x$ because the
symmetry of the model across branches imply that the properties of the
input are identical at a given distance to the soma.

Synaptic input is modeled by local (infinitely small) and transient
changes of membrane permeability to selective ionic channels. Both
excitatory (accounting for AMPA synapses) and inhibitory synapses
(accounting for GABAa synapses) are considered, their reversal
potential is E_e=0mV and E_i=-80mV respectively. Each synaptic event
is generated by a shotnoise and its effect on the conductance is a
jump followed by an exponential decay. The form of the synaptic
current is therefore:

#+NAME: eq:synaptic-currents
\begin{equation}
\left\{
\begin{split}
& i_{syn}(v,x,t) = g_e(x,t)(E_e-v)+g_i(x,t)(E_i-v) \\
& g_e(x,t) = \sum_{\big\{x_e, \{t_e\} \big\}} \delta(x-x_e) \sum_{t_e} \mathcal{H}(t-t_e) Q_e(x) \, e^{-\frac{t-t_e}{\tau_e(x)}} \\
& g_i(x,t) = \sum_{\big\{x_i, \{t_i\} \big\}} \delta(x-x_i) \sum_{t_i} \mathcal{H}(t-t_i) Q_i(x) \, e^{-\frac{t-t_i}{\tau_i(x)}}\\
\end{split}
\right.
\end{equation}

where $g_e$ and $g_i$ are linear densities of conductances. Each
synapse, indexed by $s$, has a position $x_s$ and a set of presynaptic
events \(\{t_s\}\), hence the iteration over \( \big\{x_s, \{t_s\}
\big\} \) for the sum over synapses for each synaptic
type. $\mathcal{H}$ is the Heaviside step function. The presynaptic
events $\{t_s\}$ are generated by point processes at fixed frequencies
$\nu_s$ with a given degree of synchrony, see details in the next
section[[sec:presyn-point-process]].

The model distinguishes two domains : a proximal domain with the upper
index $p$ and a distal domain with the upper index $d$ (see Figure
[[fig:model-illustration]]). Then the space-dependent quantities
(presynaptic frequencies, synaptic quantal and synaptic decay time
constant) can be written as :

#+NAME: eq:space-dep-quant
\begin{equation}
\left\{
\begin{split}
& \nu_e(x) = \nu_e^P + (\nu_e^d - \nu_e^p) \mathcal{H}(x-l_p)\\
&\nu_i(x) = \nu_i^P + (\nu_i^d - \nu_i^p) \mathcal{H}(x-l_p) \\
& Q_e(x) = Q_e^P + (Q_e^d - Q_e^p) \mathcal{H}(x-l_p)\\
& Q_i(x) = Q_i^P + (Q_i^d - Q_i^p) \mathcal{H}(x-l_p) \\
&\tau_e(x) = \tau_e^P + (\tau_e^d - \tau_e^p) \mathcal{H}(x-l_p)\\
&\tau_i(x) = \tau_i^P + (\tau_i^d - \tau_i^p) \mathcal{H}(x-l_p) 
\end{split}
\right.
\end{equation}

The continuity of the membrane potential and of the current at the
boundaries between the proximal and distal part imply:

\begin{equation}
\left\{
\begin{split}
& v(l_p^-,t) = v(l_p^+,t) \\
& \frac{1}{r_i} \frac{\partial v}{\partial x}_{l_p^-} 
= \frac{1}{r_i} \frac{\partial v}{\partial x}_{l_p^+} 
\end{split}
\right.
\end{equation}

where the limit with upper index $\pm$ indicate the limit taken from
the left or the right respectively.

At the soma, $(x=0)$, we have a lumped impedance compartment. It has
leaky RC circuit properties and also receives synaptic inhibition, the
somatic membrane potential therefore follows :

\begin{equation}
\left\{
\begin{split}
& C_M \frac{dV}{dt} + \frac{V-E_L}{R_M} + G_I(t) \, (V-E_i)  + I(t) = 0 \\
& G_i(t) = \sum_{N_i} \sum_{\{t_i\}} Q_i^p \, e^{-\frac{-(t-t_i)}{\tau_i^p}} \, \mathcal{H}(t-t_i)
\end{split}
\right.
\end{equation}

where $I(t)$ is the time-dependent input current from the soma into
the dendrite. $R_M$ and $C_M$ are the RC properties of the lumped
compartment (capital letters will indicate the somatic properties
throughout the calculus). $N_i$ is the number of somatic synapses,
each of them generates a point process $\{t_i\}$ of inhibitory
synaptic events. The properties of the somatic synapses $(\nu_i^S,
Q_i^S)$ are equivalent to the proximal ones.

This equation with the membrane potential continuity will determine
the boundary condition at the soma (x=0). We identify $V(t)=v(0,t)$,
then $I(t)$ is the current input into the dendritic tree at $x=0$ so
it verifies:

\begin{equation}
\frac{\partial v}{\partial x}_{|x=0}} = - r_i \, I(t)
\end{equation}

So:
#+NAME: eq:soma-bound
\begin{equation}
\frac{\partial v}{\partial x}_{|x=0} = r_i \, 
\Big( C_M \frac{\partial v}{\partial t}_{|x=0} + \frac{v(0,t)-E_L}{R_m} + G_I(t) \, ( v(0,t)-E_i) \Big)
\end{equation}

Finally, the last boundary condition is that all branches terminate with an infinite resistance that impede current flow (sealed-end boundary conditions):

#+NAME: eq:end-bound
\begin{equation}
\frac{\partial v}{\partial x}_{x=l} = 0
\end{equation}

Together with the biased Poisson process for event generation (see
the next section[[sec:presyn-point-process]]), the final set of equations
that describes the model, is therefore:

#+NAME: eq:model-equation
\begin{equation}
\left\{
\begin{split}
& \frac{1}{r_i} \frac{\partial^2 v}{\partial x^2} = 
c_m \frac{\partial v}{\partial t} + \frac{v-E_L}{r_m} - i_{syn}(v,x,t)\\
& \frac{\partial v}{\partial x}_{|x=0} = r_i \, 
\Big( C_M \frac{\partial v}{\partial t}_{|x=0} + \\
& \qquad \qquad \frac{v(0,t)-E_L}{R_m} + G_I(t) \, ( v(0,t)-E_i) \Big) \\
& v(l_p^-,t) = v(l_p^+,t) \\
& \frac{\partial v}{\partial x}_{l_p^-} 
= \frac{\partial v}{\partial x}_{l_p^+} \\
& \frac{\partial v}{\partial x}_{x=l} = 0
\end{split}
\right.
\end{equation}

** Model of presynaptic activity
<<sec:presyn-point-process>>

Presynaptic activity is modelled as a discrete set of presynaptic
events. Because of the apparent random spiking activity in the
fluctuation-driven regime, the basis for the generation of those
discrete events is the Poisson process. Nonetheless, we want to
reproduce the additional degree of presynaptic synchrony found in
neocortical asssemblies that result mainly for two phenomena: 1)
pairwise correlation between neurons [[refs]] and 2) muti-innervation of a
cell by a presynaptic neuron [[refs]]. We therefore introduce a variable
\(s\) that will bias the event generation of the Poisson process (\(s
\in [0,1]\)). For simplicity in the analytical treatment, synchrony in
presynaptic activity is not shared across different synapses. We
arbitrarily limit the number of coincident events to four events,
therefore for a degree of synchrony \(s\): single events have a
probability \(1-s\), double events have a probability \(s-s^2\),
triple events events have a probability \(s^2-s^3\) and quadruple
events have a probability \(s^3\). To generate a biased Poisson
process of frequency \(\nu\) with a degree of synchrony \(s\), we
therefore generate a Poisson process of frequency:

#+NAME: eq:new-freq-with-correl
\begin{equation}
\nu_{synch} = \frac{\nu}{1+s+s^2+s^3}
\end{equation}

and we duplicate (from up to four events) each event according to
their probabilities of occurence.

This is a very simplistic and limited model of presynaptic synchrony
but it is sufficient for reproducing the impact of synchrony on the
quantities investigated in this paper (only the variance of the
membrane potential fluctuations).

** Numerical implementation
<<numerical-implementation>>

The full model has been implemented numerically using the =NEURON=
software. The branched morhology was created and passive cable
properties were introduced. The spatial discretization was =nseg=30=
segments per branch. On each segment, one excitatory and one
inhibitory synapse were created, the shotnoise frequency was then
scaled according to the segment area and the synaptic density to
account for the number of synapses on this segment (using the
properties of the Poisson process, N synapses at frequency $\nu$ is a
synapse at frequency $N\nu$). Custom event generation was implemented
to introduce correlations (instead of classical =NetStim=) and fed
=NetCon= objects attached to each synapses (=ExpSyn= synapses).

** Analytical derivation of the fluctuation properties: strategy
<<sec:strategy>>

We present here a derivation that provides an analytical approximation
for the properties of the fluctuations of the membrane potential at
the soma for our model. Summing up its properties, we get: 1) a
morphology with a lumped somatic compartement and a dendritic tree of
symmetric branching following Rall's rule 2) conductance-based
synapses 3) independent excitatory and inhibitory shotnoise input
spread all over the morphology 4) assymetric properties between a
proximal part and a distal part and 5) a certain degree of synchrony
in the pre-synaptic spikes.

The properties of the membrane potential fluctuations at the soma
correspond to three stationary statistical properties of the
fluctuations: their mean $\mu_V$, their standard deviation
\(\sigma_V\) and their /global/ autocorrelation time
\(\tau_V\). Following [[citetext:Zerlaut2016]], we emphasize that the
/global/ autocorrelation time is a partial description of the
autocorrelation function (as the autocorrelation function is not
exponential) but it constitutes the first order description of the
temporal dynamics of the fluctuations.

A commonly adopted strategy in the /fluctuation-driven/ regime to
obtain statistical properties is to use stochastic calculus after
having performed the /diffusion approximation/, i.e. approximating the
synaptic conductance time course by a stochastic process, see
e.g. [[cite:Tuckwell2002]]). This approach is nonetheless not easily
generalizable to conductance input in an extended structure and render
the inclusion of assymetric properties (proximal vs distal)
complicated. We rather propose here an approach that combines
simplifying assumptions and analytical results from shotnoise theory,
it constitutes an extension of the approach proposed in
[[citetext:Kuhn2004]].

For each set of synaptic stimulation \(\{\nu^e_p, \nu_i^p, \nu_e^d,
\nu_i^d, s\}\), the derivation corresponds to the following steps:

- We transform the dendritic structure to its equivalent cylinder. The
  reduction to the equivalent cylinder is "activity-dependent" and
  captures the changes in membrane properties that results from the
  mean synaptic conductance levels.

- We derive a mean membrane potential \(\mu_V(x)\) corresponding to
  the stationary response to constant densities of conductances given
  by the means of the synaptic stimulation. We use this
  space-dependent membrane potential \(\mu_V(x)\) to fix the driving
  force all along the membrane for all synapses. The relation between
  synaptic events and the membrane potential now becomes linear.

- We derive a new cable equation that describes the variations of the
  membrane potential around this $\mu_V(x)$ solution. 

- We calculate the effect of one synaptic event on a branch \(b, b\in
  [1,B]\) at a distance $x$. We calculate the post-synaptic membrane
  potential event \($PSP_b(x,t)\) at the soma resulting from $b$
  synchronous synaptic events occuring at the distance $x$ from the
  soma. We approximate the effect of only one event by rescaling the
  response by the number of input \($PSP_b(x,t)/b\).

- We use shotnoise theory to compute the power spectrum density of the
  membrane potential fluctuations resulting from all excitatory and
  inhibitory synaptic events (including the synchrony between events).

The full derivation has been conducted with the help of the python
modulus for symbolic computation: =sympy= (deriving homogenous
solutions is relatively simple but computing coefficients with the
boudaries conditions give rise to complex expressions because of the
number of parameters). The resulting expression were then exported to
=numpy= functions for numerical evaluation. The =ipython= notebook
that presents the full derivation is available on the following [[http://nbviewer.jupyter.org/urls/bitbucket.org/yzerlaut/diverse_coupling_to_synaptic_activity/raw/master/notebooks/Fluctuations_at_soma_for_Ball_&_Rall_tree.ipynb][link]].

** From fluctuation properties to spiking probability

Focus of a previous communication, see [[citetext:Zerlaut2016]].

** Experimental preparation and electrophysiological recordings
<<sec:exp-prep>>

Experiments were performed at Unité de Neurosciences, Information et
Complexité, Gif sur Yvette, France. Experimental procedures with
animals were performed following the instructions of the European
Council Directive 2010 86/609/EEC and its French transposition (Décret
2013/118). Experimental methods were identical to those presented in
[[citetext:Zerlaut2016]]. Very briefly, we performed intracellular
recordings in the current-clamp mode using the perforated patch
technique on layer V pyramidal neurons of coronal slices of juvenile
mice primary visual cortex. For the n=13 cells presented in this
study, the access resistance R_S was [[XX]] M\(\Omega\) \(\pm\) [[YY]], the
leak current at -75mV was [[XX]] pA \(\pm\) [[YY]], cells had an input
resistance R_m of [[XX]] M$\Omega$ \(\pm\) [[YY]] and a membrane time constant
at rest of [[XX]] ms \(\pm\) [[YY]].

** Input impedance characterization
<<sec:measured-quant>>

 To determine the input impedance at the soma, we injected sinusoidal
 currents in the current-clamp mode of the amplifier (Multiclamp 700B,
 Molecular Devices), we recorded the membrane potential response to a
 current input of the form \(I(t)=I \, \sin(2\pi \, f \, t) \), we
 varied the frequencies $f$ and amplitudes $I over 40 episodes per
 cell. The frequency range scanned was [0.1, 500] Hz. For each cell,
 we determined manually the current amplitude $I_0$ that gave a \sim
 5mV amplitude in a current step protocol, from this value, the value
 of $I$ was scaled exponentially between $I_0$ at 0.1 Hz and \(50
 I_0\) at 500Hz. The reason for varying the current amplitude (and not
 only the oscillation frequency) in those input impedance protocols is
 to anticipate for the low pass filtering of the membrane and insure
 that the membrane potential response at high frequencies is far above
 the electronic noise level (\sim 0.1 mV).

After removing the first 3 periods of the oscillations (to avoid
transient effects), we fitted the membrane potential response to the
form:

\begin{equation}
V(t) = E_L + R \, I \, \sin(2\pi \, f \, t - \phi)
\end{equation}

where \(E_L, R\) and $\phi$ were fitted with a least-square
minimization procedure. The frequency dependent values of $R$ and
$\phi$ give the modulus and phase shift of the input impedance
presented in Figure [[fig:in-vitro-calib]]A

** Calibration of the morphologies
** Numerical tools

All numerical simulations of single cell dynamics have been performed
with custom code written in the numerical library of =python=: =numpy=
and optimized with the =numba= library. For the neuronal model, each
point (a mean output frequency and its standard deviation across
trials) corresponds to numerical simulations running with a time step
dt=0.01ms, for a duration of 10s and repeated 4 times with different
seeds (one simulation duration: $\sim$ 2s of real time on a Dell
Optiplex 9020 desktop computer). Experimental protocols and
online-analysis have been written in =Elphy2=. Plots and data analysis
have been done thanks to the =SciPy= package.

* Results 
\normalsize

The results are organized as follows. We first formulate our
theoretical framework for cellular computation which arbitrarily
separate the question of dendritic integration and spiking
probability. Then we present our simplified model of dendritic
morphology which we calibrated on /in vitro/ measurements. We derive
an analytical approximation for the membrane potential fluctuations at
the soma that we compare to numerical simulations using standard
compartemental modeling. We implement various types of presynaptic
activity and [[xx]]

** A theoretical framework for single cell computation in the fluctuation-driven regime

#+ATTR_LATEX: :width \linewidth
#+NAME: fig:model-illustration
#+CAPTION: *A theoretical framework for single cell computation in the fluctuation-driven regime*. *(A)* Theoretical paradigm: to get the input-output function of a single cell, we split the relation from presynaptic quantities (the input) to the spiking probability (the output) into two steps. 1) passive dendritic integration shape the membrane potential at the soma and 2) how those fluctuations are translated into spikes is captured by a firing response function determined /in vitro/ [[cite:Zerlaut2016]] *(B)* Theoretical model for dendritic integration. A single cell is made of a lumped impedance somatic compartment and a dendritic tree. The dendritic tree is composed of B branches (here B=5), the branching is symmetric and follow Rall's 3/2 rule for the branch diameters. Synapses are then spread all over the membrane according to physiological synaptic densities. We define 3 domains: a somatic and proximal domain as well as a distal domain, excitatory and inhibitory synaptic input can vary independently in those domains. An additional variable: synaptic synchrony controls the degree of coincidents synaptic inputs.
[[file:./figures/model_illustration.png]]

In the fluctuation-driven regime, the cellular input-output function
of a neocortical neuron corresponds to the function that maps the
presynaptic variables to the spiking probability of the neuron (this
is true both in a rate coding paradigm [[cite:Adrian, Shadlen]] or in a
stochastic temporal coding paradigm [[cite:Rossant]]). In addition,
because our study focuses on effects resulting from population
dynamics, the presynaptic variables will have a simple description:
firing rates and a synchrony degree.

Determining the cellular input-output functions is complex because
input of neocortical neurons are mostly in dendrites and output spikes
are generated in initial segments of an axon as reviewed in
[[citetext:Stuart2015]] and [[citetext:Debanne2011]] input will therefore
crucially shape their input-output relationship. Various parameters of
presynaptic activity can arbitrarily control the properties of the
membrane potential fluctuations at the soma. Those properties can be
quantified by identifying three somatic variables that provide a
reduced description of the dynamical state at the soma in the
/fluctuation-driven/ regime: the mean \mu_V, the standard deviation
\sigma_V of the membrane potential fluctuations and their typical
autocorrelation time $\tau_V$. For example, the excitatory/inhibitory
balance controls the mean depolarization at the soma \mu_V, the mean
synaptic bombardment impacts the standard deviation \sigma_V and the
speed of the membrane potential fluctuations \tau_V. Other effects
such as synchrony in the presynaptic spike trains or ratio between
distally and proximally targeting synaptic activity also affect the
statistical properties of the fluctuations. The effects of synaptic
input and its dendritic integration on somatic variables can be
investigated theoretically using cable theory [[cite:Tuckwell2002]] and
will be the focus of a future communication.

Because the spike initiation site lies electrotonically close to the
soma [[cite:Debanne2011]], we assume that those three purely somatic
variables will define the firing rate uniquely. In this study we
investigate the firing response in terms of those somatic variables.

** Morphological model and calibration on /in vitro/ measurements
<<sec:in-vitro-calib>>

#+ATTR_LATEX: :width \linewidth
#+NAME: fig:in-vitro-calib
#+CAPTION: *Calibrating the model on /in vitro/ measurements: the simplified model and its size variations provides an approximation for the somatic input impedance and its heterogeneity*. *(A)* Input impedance (left: modulus and right: phase shift) measured at the soma in intracellular recordings with sine-wave protocols in current-clamp (inset). The color code indicates the input resistance and is likely to result from size variations of individual cells. *(B)* A medium size model accounts for the average data and varying the size of the dendritic tree and soma reproduces the trend in the individual measurements. Large cells (blue) have a lower modulus and a lower phase shift while small cells (red) have both a higher modulus and phase shift. *(C)* Left: We obtain a map between input resistance and size of the morphological model. Right: Representation of the medium-size model. *(D)* Additionally the synaptic weights are rescaled according the the transfer resistance to soma [[to be changed for input resist]]
[[file:./figures/calibration_on_input_imped.png]]

The morphology of our theoretical model is a lumped impedance somatic
compartment in parallel with a dendritic arborization of symmetric
branching following Rall's 3/2 branching rule (see Figure
[[fig:model-illustration]]B and Methods[[sec:morphology]]). This morphology is
of course a very reductive description of pyramidal cells: it does not
discriminate between the distinct apical trunk and the very dense
basal arborization. Also branching in pyramidal cell morphologies have
been shown to deviate from Rall's 3/2 branching rule. Nonetheless

** An analytical approximation for the properties of the membrane potential fluctuations at the soma

Needed because simulations of morphologies are computationally very
expensive, very limited scan of input space is allowed.

comparison between analytical approx and simulations in =NEURON=

#+ATTR_LATEX: :width \linewidth
#+NAME: fig:analytics-accuracy
#+CAPTION: *Accuracy of the analytical approximation for the properties of the membrane potential fluctuations: comparison between numerical simulations and analytical estimates*. *(A)* Morphology corresponding to the mean model, with the 3 points where the membrane potential is recorded. *(B)* Membrane potential fluctuations for the 3 recorded locations. Note the very weal level of correlation of the membrane potential between different branches. *(C)* Properties of the membrane potential fluctuations for different configuration of presynaptic activity: analytical predictions and output from numerical simulations in =NEURON=.
[[./figures/comparison_analytics_and_sim.png]]

We emphasize here that even if the analytical description uses the
reduction to the equivalent cylinder (and therefore could be seen as
equivalent to the Ball and Stick model), the described model has
separate branches so that the fluctuations are uncorrelated from

branches to branches unlike in the Ball and Stick model.

** Properties of the fluctuations for different types of presynaptic activity

We now implement various types of presynaptic activity and investigate
the properties of the resulting membrane potential fluctuations at the
soma. In addition, we represent the variations of the somatic input
conductance (relative to the leak input conductance) because it is
routinely measured in intracellular studies /in vivo/, this quantity
therefore allows a comparison between the model and experimentally
observed activity levels. On Figure [[fig:synaptic-integration]], we
present those different protocols, on the left one can see how the
five variables of the model are comodulated for each protocol (color
coded, see bottom legend) and one the left, one can see the resulting
properties of the membrane potential fluctuations. We present those
results only for the medium-size model, but it was calculated for the
morphologies associated to all cells. The variability introduced by
the various morphologies is studied in the Supplementary Material and
we found that the qualitative behavior discussed in this section was
preserved in all cells.

#+ATTR_LATEX: :width .8\linewidth
#+NAME: fig:synaptic-integration
#+CAPTION: *Properties of the membrane potential fluctuations for different types of presynaptic activity: either unbalanced, purely proximal, purely distal, synchronized (color code)*. A common baseline configuration of low balanced proximal and distal activity gives rise to baseline fluctuations properties, then we increase a given type of activity. *(A)* Model variables to achieve varying levels of those different types of activity. *(B)* Membrane potential fluctuations properties and somatic input conductance at the soma for the different protocols. Shown for the medium-size model, see Supplementary Material for the variability introduced by variations in cell morphologies.
[[./figures/synaptic_integration.png]]

We first introduce a baseline level of presynaptic activity
corresponding to a low level of network activity: g_{tot}^{soma}/g_L
\sim 1.7, compared to \sim 3-4 in activated states, reviewed in
[[citetext:Destexhe2003]]. This baseline activity is a mix of proximal and
distal activity with a low degree of synchrony (s=0.05). Similarly to
[[cite:Kuhn2004]], the inhibitory activity is adjusted to obtain a balance
of the V_m fluctuations at -55mV. The firing values of this baseline
level are very low (\nu_e^d=\nu_e^p=[[xx]] for the excitation and
\nu_i^d=\nu_i^p=[[xx]] for the inhibition) in accordance with the sparse
activity characterizing mammalian neocortical dynamics [[refs]]. On top of
this non-specific background activity, we will now add a specific
stimulation.

We start with unbalanced activity. We define it as a stimulation that
brings the mean membrane potential above -55mV corresponding to the
previously defined balance. The stimulation corresponds to an increase
of the excitatory synaptic activity (still running within a very
sparse range of activity, \(\nu_e^d=\nu_e^p \in [0.05, 0.5]\)Hz) with
an increasing inhibitory activity adjusted to linearly disrupt nthe
balance between -55mV and -52mV (see Figure
[[fig:synaptic-integration]]). The synchrony is kept constant and the
activity indifferentially raises in the proximal and distal part. This
increase of total activity raises the input conductance ratio close to
4. In this moderate range, the variations of the amplitude of the
fluctuations \sigma_V remains a monotonic increase (unlike the
non-monotonic variations found in the single-compartment study of
[[citetext:Kuhn2004]] and the case of a proximal stimulation, see below),
the fluctuations gets approximately twice faster (the normalized
autocorrelation time \tau_V/\tau_m^0 decays from 100% to 50%) and, of
course (by design), the mean depolarization has a linear increase of
3mV.

We now emulate purely proximal activity. To this purpose, we fix the
distal presynaptic firing frequencies (\nu_e^d and \nu_i^d) as well as
the synchrony to their baseline levels. To remain in a sparse activity
level, we increase the proximal excitatory activity from the baseline
level to 1.7Hz and we adjust proximal and somatic inhibitory activity
to keep the balance at the soma.  This would nonethless correspond to
large network activity level, as can be seen from the input
conductance ratio (that raises up to 8). This situation gives results
comparable to the single-compartment study of [[citetext:Kuhn2004]]. The
amplitude of the fluctuations has a non-monotonic profile and the
autocorrelation time strongly decreases. A notable difference is that,
even if we investigated high activity levels, the autocorrelation time
does not goes to zero and the amplitude of the fluctuations has only a
moderate decrease. This discrepancy is due to 1) the choice of
non-negligible synaptic time constants compared to the membrane time
constants (here \tau_{syn}=5ms and \tau_m^0 \sim 25ms, then
\tau_V/tau_m^0 would saturate at \tau_{syn}/tau_m^0 = 20%) and 2) the
fact that the synaptic input is distributed attenuates the strong
shunting effects observed in the single compartment case.

For distal activity, we keep the proximal presynaptic frequencies
(\nu_e^p and \nu_i^p) as well as the synchrony to their baseline
levels. We increase the distal excitatory activity from the baseline
level to a moderate level: 0.7Hz. The distal inhibitory frequency is
again adjusted to keep the balance at the soma. Here, we get a
different picture than in the proximal case, the increase in activity
leads to negligible increase of the somatic input conductance as
expected from electrotonically distant input
[[cite:syn-visibility-koch]]. Also, the decrease of the speed of the
fluctuations is much attenuated, the reason for this is that only the
distal part has a high conductance, consequently post-synaptic events
are strongly low-pass filtered by the proximal part of the
arborization before reaching the soma. Here, the amplitude of the
fluctuations strongly increases as a function of the input and do not
show the non-monotonic relation found for proximal input. This is
explain by the combination of the fact that 1) distal events are of
higher amplitude and 2) the shunting of post-synaptic events is much
reduced due to the relatively narrow localization of the synaptic
conductances.

Finally, we emulate an increase in the presynaptic synchrony. Here,
all synaptic frequencies are kept constant with respect to the
baseline level and we simply increase the probability of coincident
events for each synaptic spike train. Because there is no change in
synaptic activity, this stimulation does not affect the input
conductance ratio, neither the mean membrane potential or the speed of
the fluctuations. However, presynaptic synchrony strongly affects the
amplitude of the fluctuations in a near linear manner.

Note, that in addition to the sparse activity constraints or the
balance constraints, the criteria for the ranges of the model
variables was manually choosen to have the fluctuations in the same
domain. For example, we investigated a lower activity range for the
distal part than for the proximal part to avoid an explosion of
\sigma_V, the range for the synchrony increase follow the same
criteria.

We thus demonstrated here, that, in a theoretical model of dendritic
integration, the properties of the fluctuations (\mu_V, \sigma_V,
\tau_V) can follow various comodulations, depending on the properties
of the synaptic stimulation. This behavior is what motivated to fully
scan the three dimensional space (\mu_V, \sigma_V, \tau_V) in our
companion study and not only one comodulation type, see
[[citetext:Rauch2003]] as an example [[find better]], it would correspond to
the single-compartment approximation with current-based synapses .

** Heterogeneous firing response induce diverse coupling to the types of synaptic activity

We take here the dataset of our companion study [[cite:Zerlaut2016]]

#+ATTR_LATEX: :width \linewidth
#+NAME: fig:analytics-accuracy
#+CAPTION: *Examples of the firing response of 4 different cells for the input shown in Figure [[fig:synaptic-integration]]. The cells 1 to 4 are identical as those presented in Figure 5 of [[citetext:Zerlaut2016]].*
[[./figures/firing_response_examples.png]]

\newpage

** Biophysical origin of the heterogenous couplings to presynaptic activities

Because we want to focus on the specificity of each cell, being either
couple to one or the

see Figure [[fig:coupling-correlation]]

#+ATTR_LATEX: :width \linewidth :float multicolumn
#+NAME: fig:coupling-correlation
#+CAPTION: *Correlating specific synaptic coupling to biophysical features.*
[[./figures/coupling_correlations.png]]

* Discussion

In this communication, by introducing an analytically tractable
dendritic model, we presented the final form of our theoretical
framework for single cell computation in the fluctuation-driven
regime.

** An analytical model for dendritic integration in the fluctuation-driven regime

we provided a stratey for the analytical treatment of dendritic
integration in the fluctuation-driven regime that relies on 1)
shotnoise theory, 2) cable theory and 3) adequate approximations.

The main advantage of this model is that you can very naturall plug in
physiological parameters (because surface area is physiological as
well as transfer resistance to soma) and still it remains analytical.

Literature suffers from the reduction to single-compartment

The current model provides a tool to make network dynamics question
amenable to mathematical analysis with morphologically detailed
models.

Rely on calculating PSP events and opens the way toward event based
simulations of dendritic integration in the high conductance state
(though including approximation).

** Limitations of the proposed theoretical framework for single-cell computation

Only enables to scan sensory processing

** Heterogeneity of morpological and passive neuronal properties

In this study, the rescaling rule between input resistance at the soma
and the size of the morphological model has led to the invariance in
the relation between input (presynaptic variables) and the fluctuation
properties. Thus the heterogeneity in morpholgies (here only cell
sizes) had very little effects on the heterogeneity of cell responses.



 a rescaling of the

The reason for 

** Diverse coupling to proximal activity

Note that proximal activity in our theoretical model has a rather
large extent, six seventh of the dendritic tree belongs to the
proximal part.


Let's speculate about the
blabla

** Interaction between circuit properties and biophysical properties

blabla 

** Sodium inactivation and sensitivities to $\tau_V$

blabla   

* Supplementary information

** Supplementary material

Supplementary material contains the detailed mathematical derivation
of the membrane potential fluctuations

** Acknowledgments

We would like to thank Gilles Ouanounou for his help during
electrophysiological recordings and Gérard Sadoc for assistance with
the acquisistion software. We also thank Manon Richard and Aurélie
Daret for animal facilities.

** Funding

Y.Z was supported by fellowships from the Initiative d'Excellence
Paris-Saclay and the Fondation pour la Recherche Médicale (FDT
20150532751). Research funded by the CNRS, the ANR (Complex-V1
project) and the European Community (BrainScales FP7-269921 and the
Human Brain Project FP7-604102). The authors declare no competing
financial interests.

** Author contributions

Y.Z. and A.D. designed research. Y.Z performed research and wrote the
present draft.

* References
\bibliography{tex/biblio}

